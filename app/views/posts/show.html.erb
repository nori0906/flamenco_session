<div class="bkg-img">
  <h1 class="text-white  text-left ps-5 py-3 mb-5 bg-dark bg-gradient">詳細</h1>
  <div class="container">

    <%# コラボが2回以上されていなければボタンを表示 %>
    <% unless @root_collab_post %>
        <div class="d-grid gap-2">
        <%# コラボ音声取得のためにクエリパラメータに投稿idを設定 %>
          <%= link_to 'セッションする', new_post_path(audio_flg: "post_audio", collab_post_id: @post.id), type: "button", class: "btn btn-custom  text-white border border-dark" %>
        </div>
    <% end %>

    <%# カードレイアウト実装 8/17 %>
    <div class="card">
      <div class="card-header">
        Featured
      </div>
      <div class="card-body">
        <h5 class="card-title">Special title treatment</h5>
        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
        <a href="#" class="btn btn-primary">Go somewhere</a>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <h2 class="card-title"><%= "#{@post.title}" %></h2>

        <%# 音源 %>
        <% if @post.voice.attached? %>
          <p><%= audio_tag(url_for(@post.voice), controls: true, id: "record") %></p>
          <p><span id= "output">0.000</span></p>
          <% if @post.collab_src.present? %>
            <p><%= audio_tag(url_for(@parent_post.voice), controls: true, id: "refRecord") %></p>
            <p><span id= "output2">0.000</span></p>
            <p>コラボ元</p>
          <% end %>
          <p><span id= "output3">0.000</span></p>
          <div>
              <button type="button" class="btn btn-outline-secondary mb-3" id="playback">再生</button>
              <button type="button" class="btn btn-outline-secondary mb-3" id="stopBtn">停止</button>
          </div>
        <% end %>

        <p class="card-text "><%= "#{@post.body}" %></p>
        <%# 自身のみ表示 %>
        <p class="card-text"><%= "#{@post.status}" %></p>

        <p class="card-text"><%= "ユーザー名: #{@post.user.name}" %></p>
        
        
        <p class="card-text"><%= "ID: #{@post.id}" %></p>
        
        <% if @post.collab_src.present? %>
          <p class="card-text"><%= "コラボ投稿" %></p>
        <% else %>
          <p class="card-text"><%= "通常投稿" %></p>
        <% end %>

      </div>
    </div>

  </div>
</div>




<%= javascript_pack_tag 'playback-audio' %>